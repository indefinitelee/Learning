<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Lee Wilson Test</title>
  <link rel="stylesheet" href="">
</head>
<style>
.node {
  border: solid 1px white;
  font: 10px sans-serif;
  line-height: 12px;
  overflow: hidden;
  position: absolute;
  text-indent: 2px;
}
</style>

<body>
</body>
<svg width="960" height="570"></svg>
<script src="https://d3js.org/d3.v4.min.js"></script>

<script>

  var svg = d3.select("svg"),
      width = +svg.attr("width"),
      height = +svg.attr("height");

  const treemap = d3.treemap()
        .tile(d3.treemapResquarify)
        .size([width, height])
        .round(true)
        .paddingInner(1);

  d3.json("http://localhost:8000/Data/data.json", function(error, data) {
    if (error) throw error;

    const root = d3.hierarchy(data)
        .eachBefore(function(d) {d.data.id = (d.parent ? d.parent.data.id + "." : "") + d.data.title; })
        .sum(sumBySize)
        .sort(function(a,b) {return b.height - a.height || b.value - a.value; });

      treemap(root);

    var cell = svg.selectAll("g")
        .data(root.leaves())
        .enter().append("g")
        .attr("transform", function(d) { return "translate(" + d.x0 + "," + d.y0 + ")"; });

    cell.append("rect")
        .attr("id", function(d) { return d.data.id; })
        .attr("width", function(d) { return d.x1 - d.x0; })
        .attr("height", function(d) { return d.y1 - d.y0; })
        .attr("fill", function(d) { return color(d.parent.data.id); });

  });

function sumByCount(d) {
  return d.children ? 0 : 1;
}

function sumBySize(d) {
  return d.size;
}


</script>
</html>

